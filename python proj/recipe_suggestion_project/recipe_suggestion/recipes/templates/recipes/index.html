{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Recipe Finder</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #fafafa;
    }

    nav {
      background-color: #333;
      padding: 10px 0;
      text-align: center;
    }

    nav ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    nav ul li {
      display: inline;
      margin: 0 20px;
    }

    nav ul li a {
      color: white;
      text-decoration: none;
      font-size: 18px;
      transition: color 0.3s;
    }

    nav ul li a:hover {
      color: #ff6347;
    }

    header {
      background-color: #ff6347;
      color: white;
      text-align: center;
      padding: 2rem 1rem;
    }

    header h1 {
      margin: 0;
      font-size: 2.5rem;
    }

    header p {
      margin: 10px 0 0;
      font-size: 1.2rem;
    }

    .search-section {
      text-align: center;
      margin: 2rem auto;
    }

    .search-section input {
      width: 60%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 8px;
    }

    .search-section button {
      padding: 10px 20px;
      margin-left: 10px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      background-color: #ff6347;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .search-section button:hover {
      background-color: #e5533d;
    }

    .categories {
      text-align: center;
      padding: 1rem;
    }

    .categories h2 {
      font-size: 1.8rem;
      margin-bottom: 1rem;
    }

    .category-grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 1rem;
      padding: 0 1rem;
    }

    .category {
      background-color: #ffffff;
      padding: 1rem 1.5rem;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      font-size: 1.1rem;
      text-decoration: none;
      color: #333;
      transition: transform 0.3s ease, background-color 0.3s ease;
    }

    .category:hover {
      background-color: #ffe0d6;
      transform: translateY(-3px);
    }

    .recipes-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
      padding: 2rem;
    }

    .recipe-card {
      background-color: white;
      border-radius: 10px;
      box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.1);
      padding: 1rem;
    }

    .recipe-card h3 {
      margin-top: 0;
    }

    .recipe-card ul, .recipe-card ol {
      padding-left: 20px;
    }

  
  #authSection {
    text-align: center;
    margin: 50px auto;
    width: 300px;
    padding: 20px;
    border: 1px solid #ccc;
    border-radius: 10px;
    background-color: #fdfdfd;
  }
  #authSection input {
    display: block;
    width: 90%;
    margin: 10px auto;
    padding: 10px;
  }
  #authSection button {
    padding: 10px 20px;
    cursor: pointer;
  }


  </style>
</head>
<body>
  

  <nav>
    <ul>
      <li><a href="{% url 'home' %}">Home</a></li>
      <li><a href="{% url 'cuisines' %}">Cuisines</a></li>
      <li><a href="{% url 'desserts' %}">Desserts</a></li>
      <li><a href="{% url 'lunch' %}">Lunch</a></li>
      <li><a href="{% url 'dinner' %}">Dinner</a></li>
      <li><a href="{% url 'breakfast' %}">Breakfast</a></li>
    </ul>
  </nav>

  <header>
    <h1>üç≤ Recipe Finder</h1>
    <p>Discover recipes by ingredients or explore categories</p>
  </header>

  <section class="search-section">
    <input type="text" id="ingredientInput" placeholder="Enter ingredients (e.g. tomato, rice)" />
    <button onclick="searchRecipes()">Search</button>
  </section>

  <section class="categories">
    <h2>Explore by Category</h2>
    <div class="category-grid">
      <a href="{% url 'cuisines' %}" class="category">üåç Cuisines</a>
      <a href="{% url 'snacks' %}" class="category">ü•™ Snacks</a>
      <a href="{% url 'desserts' %}" class="category">üç∞ Desserts</a>
      <a href="{% url 'lunch' %}" class="category">üçõ Lunch</a>
      <a href="{% url 'dinner' %}" class="category">üçΩÔ∏è Dinner</a>
      <a href="{% url 'breakfast' %}" class="category">ü•û Breakfast</a>
    </div>
  </section>

  <section id="recipeResults" class="recipes-grid">
    <!-- Search results appear here -->
  </section>
  <h3>Select Recipe Mode:</h3>
<button onclick="setMode('online')">Online Mode</button>
<button onclick="setMode('offline')">Offline Mode</button>
  <script>
const dummyRecipes = [
    {
      name: "Tomato Pasta",
      ingredients: ["tomato", "pasta", "olive oil", "garlic"],
      cuisine: "Italian",
      steps: [
        "Boil pasta until al dente.",
        "Saut√© garlic in olive oil, add chopped tomatoes.",
        "Mix in boiled pasta and cook for 2 minutes."
      ]
    },
    {
      name: "Egg Fried Rice",
      ingredients: ["egg", "rice", "soy sauce", "onion", "carrot"],
      cuisine: "Asian",
      steps: [
        "Scramble eggs and set aside.",
        "Saut√© chopped onion and carrot.",
        "Add rice and soy sauce, mix in eggs, and stir-fry everything together."
      ]
    },
    {
      name: "Grilled Cheese",
      ingredients: ["bread", "cheese", "butter"],
      cuisine: "American",
      steps: [
        "Butter the bread slices on one side.",
        "Place cheese between slices with buttered sides out.",
        "Grill on pan until golden brown on both sides."
      ]
    },
    {
      name: "Vegetable Sandwich",
      ingredients: ["bread", "cucumber", "tomato", "lettuce", "mayonnaise"],
      cuisine: "Continental",
      steps: [
        "Spread mayonnaise on bread.",
        "Layer lettuce, cucumber, and tomato slices.",
        "Cover with another slice and cut into halves."
      ]
    },
    {
      name: "Paneer Curry",
      ingredients: ["paneer", "onion", "tomato", "spices", "cream"],
      cuisine: "Indian",
      steps: [
        "Saut√© onion and tomato with spices.",
        "Add paneer cubes and cook for 5 minutes.",
        "Stir in cream and simmer for 3 minutes."
      ]
    },
    {
      name: "Banana Pancakes",
      ingredients: ["banana", "flour", "milk", "egg", "sugar"],
      cuisine: "American",
      steps: [
        "Mash bananas and mix with flour, milk, egg, and sugar.",
        "Pour batter onto a hot pan and cook until bubbles form.",
        "Flip and cook until golden brown."
      ]
    }
  ];



  function setMode(mode) {
  localStorage.setItem("recipe_mode", mode);
  alert("Mode set to " + mode.toUpperCase()); // Optional feedback
  applyModeFromStorage(); // Immediately apply mode on the current page
}
function applyModeFromStorage() {
  const mode = localStorage.getItem("recipe_mode");
  const offlineContainer = document.getElementById("offline-recipes");
  const onlineContainer = document.getElementById("online-recipes");

  if (mode === "online") {
    offlineContainer.style.display = "none";
    onlineContainer.style.display = "block";

    fetch("https://www.themealdb.com/api/json/v1/1/search.php?f=a")
      .then(response => response.json())
      .then(data => {
        const apiRecipes = document.getElementById("api-recipes");
        if (!apiRecipes) return;
        apiRecipes.innerHTML = "";

        data.meals.forEach(meal => {
          const div = document.createElement("div");
          div.classList.add("recipe-card");

          let ingredients = "";
          for (let i = 1; i <= 20; i++) {
            const ingredient = meal["strIngredient" + i];
            const measure = meal["strMeasure" + i];
            if (ingredient && ingredient.trim() !== "") {
              ingredients += `<li>${ingredient} - ${measure}</li>`;
            }
          }

          div.innerHTML = `
            <h3>${meal.strMeal}</h3>
            <img src="${meal.strMealThumb}" alt="${meal.strMeal}" width="250">
            <h4>Ingredients:</h4>
            <ul>${ingredients}</ul>
            <h4>Instructions:</h4>
            <p>${meal.strInstructions}</p>
            ${meal.strYoutube ? `<a href="${meal.strYoutube}" target="_blank">Watch Video</a>` : ""}
          `;

          apiRecipes.appendChild(div);
        });
      });
  } else {
    onlineContainer.style.display = "none";
    offlineContainer.style.display = "block";
  }
}


window.addEventListener("load", applyModeFromStorage);


function searchRecipes() {
  const input = document.getElementById("ingredientInput").value.toLowerCase();
  const ingredients = input.split(",").map(i => i.trim());
  const container = document.getElementById("recipeResults");
  container.innerHTML = "";

  const mode = localStorage.getItem("recipe_mode");

  if (mode === "online") {
    // Online Mode: Fetch recipes from API
    fetch(`https://www.themealdb.com/api/json/v1/1/filter.php?i=${input}`)
      .then(response => response.json())
      .then(data => {
        const results = data.meals || [];
        if (results.length === 0) {
          container.innerHTML = "<p style='text-align:center;'>No recipes found.</p>";
          return;
        }

        results.forEach(meal => {
          const card = document.createElement("div");
          card.className = "recipe-card";
          card.innerHTML = `
            <h3>${meal.strMeal}</h3>
            <img src="${meal.strMealThumb}" alt="${meal.strMeal}" width="250">
            <p><strong>Ingredients:</strong> ${meal.strIngredients}</p>
            <a href="https://www.youtube.com/watch?v=${meal.strYoutube}" target="_blank">Watch Recipe Video</a>
          `;
          container.appendChild(card);
        });
      })
      .catch(error => {
        console.error("Error fetching recipes:", error);
        container.innerHTML = "<p style='text-align:center;'>Error fetching recipes. Please try again later.</p>";
      });
  } else {
    // Offline Mode: Filter recipes from dummy data
    const results = dummyRecipes.filter(recipe =>
      ingredients.every(ing => recipe.ingredients.includes(ing))
    );

    if (results.length === 0) {
      container.innerHTML = "<p style='text-align:center;'>No recipes found.</p>";
      return;
    }

    results.forEach(recipe => {
      const card = document.createElement("div");
      card.className = "recipe-card";
      card.innerHTML = `
        <h3>${recipe.name}</h3>
        <p><strong>Cuisine:</strong> ${recipe.cuisine}</p>
        <p><strong>Ingredients:</strong> ${recipe.ingredients.join(", ")}</p>
        <p><strong>Steps:</strong></p>
        <ol>${recipe.steps.map(step => `<li>${step}</li>`).join("")}</ol>
      `;
      container.appendChild(card);
    });
  }
}



  
  /*const dummyRecipes = [
    { name: "Tomato Pasta", ingredients: ["tomato", "pasta"], cuisine: "Italian" },
    { name: "Egg Fried Rice", ingredients: ["egg", "rice", "soy sauce"], cuisine: "Asian" },
    { name: "Grilled Cheese", ingredients: ["bread", "cheese", "butter"], cuisine: "American" },
  ];
  
  function searchRecipes() {
    const input = document.getElementById("ingredientInput").value.toLowerCase();
    const ingredients = input.split(",").map(i => i.trim());
    const container = document.getElementById("recipeResults");
    container.innerHTML = "";
  
    const results = dummyRecipes.filter(recipe =>
      ingredients.every(ing => recipe.ingredients.includes(ing))
    );
  
    if (results.length === 0) {
      container.innerHTML = "<p style='text-align:center;'>No recipes found.</p>";
      return;
    }
  
    results.forEach(recipe => {
      const card = document.createElement("div");
      card.className = "recipe-card";
      card.innerHTML = `
        <h3>${recipe.name}</h3>
        <p><strong>Cuisine:</strong> ${recipe.cuisine}</p>
        <p><strong>Ingredients:</strong> ${recipe.ingredients.join(", ")}</p>
      `;
      container.appendChild(card);
    });
  }*/
  /* function searchRecipes() {
      const ingredient = document.getElementById('ingredientInput').value;
      fetch(`/search-recipes/?ingredient=${ingredient}`)
          .then(response => response.json())
          .then(data => {
              const resultsContainer = document.getElementById('recipeResults');
              resultsContainer.innerHTML = ''; // Clear previous results
              data.forEach(recipe => {
                  const recipeElement = document.createElement('div');
                  recipeElement.classList.add('recipe');
                  recipeElement.innerHTML = `
                      <h3>${recipe.name}</h3>
                      <p>${recipe.cuisine}</p>
                      <p>${recipe.ingredients}</p>
                      <a href="/recipe/${recipe.id}">View Recipe</a>
                  `;
                  resultsContainer.appendChild(recipeElement);
              });
          });
    }*/
</script>
  <!--<script src="{% static 'script.js' %}"></script>-->

</body>
</html>




  